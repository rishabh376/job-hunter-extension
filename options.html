    <label>Provider Endpoint (advanced, optional)
      <input type="text" id="aiEndpoint" placeholder="http://localhost:1234 or http://localhost:8080">
      <span class="small" style="display:block;color:#888">Override for LM Studio/Ollama (use CORS proxy if needed)</span>
    </label>
  <div id="corsProxyHelp" class="small" style="margin-top:10px;color:#c00">
    <b>Note for LM Studio/Ollama users:</b> If you see network or CORS errors, run the included <code>utils/cors-proxy.js</code> (see OPTIONS-FULL-EXECUTION.md) and set the endpoint to <code>http://localhost:8080</code> in the provider settings.
  </div>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Job Hunter Pro - Settings</title>
  <style>
    body{font-family: Arial, Helvetica, sans-serif;padding:16px;max-width:720px}
    label{display:block;margin-top:8px}
    input[type=text], input[type=email], input[type=tel]{width:100%;padding:6px;margin-top:4px}
    .row{display:flex;gap:8px}
    .col{flex:1}
    .actions{margin-top:12px}
    .small{font-size:12px;color:#666}
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center}
    .modal.show{display:flex}
    .modal-content{background:white;padding:20px;border-radius:8px;max-width:400px;box-shadow:0 2px 10px rgba(0,0,0,0.2)}
    .modal-content h2{margin-top:0;color:#333}
    .modal-content p{color:#666;line-height:1.5}
    .modal-content ul{margin:8px 0;padding-left:20px}
    .modal-buttons{margin-top:16px;display:flex;gap:8px;justify-content:flex-end}
    .modal-buttons button{padding:8px 16px;border:1px solid #ddd;background:#f0f0f0;cursor:pointer;border-radius:4px}
    .modal-buttons button.danger{background:#ff4444;color:white;border-color:#cc0000}
    .modal-buttons button:hover{background:#e0e0e0}
    .modal-buttons button.danger:hover{background:#dd0000}
    .status-line{margin-top:8px;padding:8px;background:#e8f5e9;border-left:3px solid #4caf50;font-size:12px}
    .status-line.warn{background:#fff3e0;border-left-color:#ff9800}
    .status-line.error{background:#ffebee;border-left-color:#f44336}
  </style>
</head>
<body>
  <h1>Job Hunter Pro — Settings</h1>
  <p class="small">Configure your resume and application preferences. Resume file (PDF) will be stored locally in extension storage.</p>

  <label>Auto-apply
    <input type="checkbox" id="autoApply">
  </label>

  <h2>Personal Info</h2>
  <div class="row">
    <div class="col">
      <label>First name<input type="text" id="firstName"></label>
    </div>
    <div class="col">
      <label>Last name<input type="text" id="lastName"></label>
    </div>
  </div>
  <label>Email<input type="email" id="email"></label>
  <label>Phone<input type="tel" id="phone"></label>
  <div class="row">
    <div class="col"><label>City<input type="text" id="city"></label></div>
    <div class="col"><label>State<input type="text" id="state"></label></div>
  </div>

  <h2>Resume File (PDF)</h2>
  <input type="file" id="resumeFile" accept="application/pdf">
  <div id="resumeInfo" class="small"></div>

  <h2>AI / Resume Optimization</h2>
    <label>Provider
    <select id="aiProvider">
      <option value="openai">OpenAI</option>
      <option value="google">Google Generative API</option>
      <option value="ollama">Ollama (local)</option>
      <option value="lmstudio">LM Studio (local)</option>
    </select>
  </label>
  <label>API Key (if using provider)
    <input type="text" id="openaiApiKey" placeholder="sk-... or GOOGLE_API_KEY">
    <span class="small" style="display:block;color:#888">Not required for Ollama or LM Studio</span>
  </label>
  <label>Model
    <input type="text" id="aiModel" placeholder="gpt-3.5-turbo or dolphin-2.2.1-mistral-7b">
    <span class="small" style="display:block;color:#888">For LM Studio, enter the model name exactly as loaded (e.g., dolphin-2.2.1-mistral-7b)</span>
  </label>
    <div id="lmstudioHelp" class="small" style="margin-top:10px;color:#444">
      <b>LM Studio usage:</b> Start LM Studio, load your model, and ensure the API is running at <code>http://localhost:1234</code>.<br>
      Select <b>LM Studio (local)</b> as provider, enter your model name, and leave API key blank.
    </div>
  <label>Encryption passphrase (optional)
    <input type="password" id="apiPassphrase" placeholder="Passphrase to encrypt API key">
  </label>
  <div id="sessionStatusLine" class="status-line" style="display:none;margin-top:8px"></div>
  <div style="margin-top:6px">
    <label style="display:inline-block;margin-right:12px"><input type="checkbox" id="allowPlainKey"> Allow storing plain API key (not recommended)</label>
  </div>
  <div style="margin-top:6px">
    <button id="encryptKeyBtn" class="btn">Encrypt & Save API Key</button>
    <button id="encryptValidateBtn" class="btn">Encrypt + Validate</button>
    <button id="testSaveBtn" class="btn">Test & Save</button>
    <button id="validateKeyBtn" class="btn">Validate API Key</button>
    <button id="unlockKeyBtn" class="btn">Unlock API Key for Session</button>
    <span id="apiStatus" class="small"></span>
  </div>

  <div style="margin-top:8px">
    <label class="small">Validation response (raw):</label>
    <pre id="validateResult" style="background:#f8f8f8;border:1px solid #eee;padding:8px;max-height:180px;overflow:auto;white-space:pre-wrap;font-size:12px"></pre>
  </div>

  <div class="actions">
    <button id="saveBtn" class="btn">Save</button>
    <button id="clearBtn" class="btn">Clear</button>
    <span id="status" class="small"></span>
  </div>

  <div id="plainKeyModal" class="modal">
    <div class="modal-content">
      <h2>⚠️ Security Warning</h2>
      <p>You are enabling plain-text API key storage. This is <strong>not recommended</strong> as your API key could be exposed if:</p>
      <ul>
        <li>Your device is compromised</li>
        <li>Malware accesses browser storage</li>
        <li>You accidentally share your browser profile</li>
      </ul>
      <p><strong>Recommended:</strong> Use encryption with a passphrase instead.</p>
      <div class="modal-buttons">
        <button id="modalCancel">Cancel</button>
        <button id="modalConfirm" class="danger">Allow (I understand the risks)</button>
      </div>
    </div>
  </div>

  <script src="utils/storage-promise.js"></script>
  <script src="utils/crypto.js"></script>
  <script src="utils/api-connector.js"></script>
  <script src="options.js"></script>
</body>
</html>